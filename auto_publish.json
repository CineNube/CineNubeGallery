function autoPublish() {
  const sheet = SpreadsheetApp.openById("1fHOhQ9ZtU-JlVPWhH_3_th_PdNP9CL57tT_pI1NNil4").getSheetByName("prueba12");
  const headers = sheet.getRange(1,1,1,sheet.getLastColumn()).getValues()[0];
  const rows = sheet.getDataRange().getValues().slice(1);

  rows.forEach((row,i)=>{
    const enviar = row[headers.indexOf("Enviar")];
    const enviado = row[headers.indexOf("Enviado")];
    const actualizar = row[headers.indexOf("Actualizar")];
    if(String(enviar||'').toLowerCase()==='si' && String(enviado||'').toLowerCase()!=='si'){
      sheet.getRange(i+2, headers.indexOf("Enviado")+1).setValue('si');
      sheet.getRange(i+2, headers.indexOf("published_at")+1).setValue(new Date().toISOString());
    }
    if(String(actualizar||'').toLowerCase()==='si'){
      sheet.getRange(i+2, headers.indexOf("Actualizar")+1).setValue('');
      sheet.getRange(i+2, headers.indexOf("updated")+1).setValue(new Date().toISOString());
      sheet.getRange(i+2, headers.indexOf("published_at")+1).setValue(new Date().toISOString());
    }
  });
}
