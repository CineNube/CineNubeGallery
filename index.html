<section id="gallery"></section>
<script>
const SHEET_URL = "https://api.sheetbest.com/sheets/4b4d9aed-b6a1-414d-a2d4-5c7605b85501";
const gallery = document.getElementById('gallery');
let catalogo = [];

function showItems(filter) {
  gallery.innerHTML = '';
  const items = catalogo.filter(i => {
    if(filter==='movies') return i.type==='movie';
    if(filter==='series') return i.type==='series';
    return true;
  });

  items.forEach(item=>{
    const div = document.createElement('div');
    div.className = 'item';

    const img = document.createElement('img');
    img.src = item.poster || 'https://via.placeholder.com/200x300?text=Sin+Imagen';
    div.appendChild(img);

    const h3 = document.createElement('h3');
    h3.textContent = item.title;
    div.appendChild(h3);

    if(item.type==='movie' && item.terabox){
      const link = document.createElement('a');
      link.href = item.terabox;
      link.target='_blank';
      link.textContent = 'Ver Película';
      div.appendChild(link);
    }

    if(item.type==='series' && item.season_links){
      try{
        const seasons = JSON.parse(item.season_links);
        seasons.forEach(s=>{
          const btn = document.createElement('a');
          btn.href = s.link;
          btn.target='_blank';
          btn.textContent = `Temporada ${s.season}`;
          div.appendChild(btn);
        });
      }catch(e){ console.error("Error season_links", e);}
    }

    gallery.appendChild(div);
  });
}

fetch(SHEET_URL)
  .then(r=>r.json())
  .then(data=>{
    catalogo = data.filter(row=>row.title);
    showItems('movies');
  })
  .catch(e=>{
    gallery.innerHTML = '<p style="color:tomato;">Error cargando catálogo</p>';
    console.error(e);
  });
</script>
