<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CineNube Gallery</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>CineNube Gallery</h1>
  <nav>
    <button id="btn-todo">Todo</button>
    <button id="btn-peliculas">Películas</button>
    <button id="btn-series">Series</button>
  </nav>
</header>
<main id="catalogo"></main>
<script src="catalogo.html.js"></script>
<script>
const SHEET_JSON_URL = "https://script.google.com/macros/s/AKfycbx1Vq5HqmPMExtgm1PRgct2WRzGex5BTEtDERIKHA20VZNFf-umdHpiKD94Df80S2vO1g/exec";

async function cargarCatalogo(filtro='todo') {
  const res = await fetch(SHEET_JSON_URL);
  const data = await res.json();
  let items = data;
  if(filtro==='movie') items = data.filter(d=>d.type==='movie');
  if(filtro==='series') items = data.filter(d=>d.type==='series');
  mostrarItems(items);
}

function mostrarItems(items){
  const container = document.getElementById('catalogo');
  container.innerHTML='';
  items.forEach(item=>{
    const card=document.createElement('div');
    card.className='card';
    let seasonsHTML='';
    if(item.season_links && item.season_links.length>0){
      item.season_links.forEach(s=>{
        seasonsHTML+='<a href="'+s.link+'" target="_blank">Temporada '+s.season+'</a> ';
      });
    } else if(item.type==='series') seasonsHTML='Sin temporadas';
    card.innerHTML=`
      <img src="${item.poster}" alt="${item.title}">
      <h2>${item.title}</h2>
      <p>${item.overview}</p>
      <p>⭐ ${item.rating} | ${item.year}</p>
      <div>${seasonsHTML}</div>
    `;
    container.appendChild(card);
  });
}

document.getElementById('btn-todo').addEventListener('click',()=>cargarCatalogo('todo'));
document.getElementById('btn-peliculas').addEventListener('click',()=>cargarCatalogo('movie'));
document.getElementById('btn-series').addEventListener('click',()=>cargarCatalogo('series'));

cargarCatalogo();
</script>
</body>
</html>
