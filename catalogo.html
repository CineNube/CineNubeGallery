<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Cat√°logo completo de pel√≠culas y series - CineNube Gallery">
<title>üìö Cat√°logo - CineNube Gallery</title>
<link rel="icon" href="https://cinenube.github.io/CineNubeGallery/favicon.png" type="image/png">
<style>
body { font-family: Arial,sans-serif; background:#0e0e0e; color:#fff; margin:0; padding:0; }
header { text-align:center; background:#141414; padding:15px; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; box-shadow:0 2px 10px rgba(0,0,0,.5);}
header button { background:#ff4444; color:#fff; border:none; padding:8px 16px; border-radius:20px; cursor:pointer; transition:.3s; }
header button:hover { background:#ff6666; }
#search { width:90%; max-width:500px; margin:10px auto; display:block; padding:10px; border-radius:6px; border:none; font-size:16px; }
.grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); gap:15px; padding:20px; }
.card { background:#1c1c1c; border-radius:10px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,.3); transition:transform .3s; }
.card:hover { transform:scale(1.03); }
.poster { width:100%; height:220px; object-fit:cover; }
.content { padding:10px; }
.title { font-size:1em; font-weight:bold; color:#ff4444; margin:5px 0; }
.desc { font-size:0.85em; color:#ccc; margin-top:5px; }
.link { display:block; background:#ff4444; color:#fff; text-align:center; padding:6px; margin-top:8px; border-radius:5px; font-weight:bold; text-decoration:none; font-size:0.9em; }
.link:hover { background:#ff6666; }
footer { text-align:center; padding:20px; background:#141414; color:#aaa; font-size:0.9em; }

@media (max-width:768px) {
  .poster { height:180px; }
  .title { font-size:0.95em; }
  .desc { font-size:0.8em; }
  .link { font-size:0.85em; padding:5px; }
}
@media (max-width:480px) {
  .poster { height:150px; }
  .grid { grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); }
  header { flex-direction:column; }
}
</style>
</head>
<body>

<header>
  <button onclick="setCategory('all')">üî• Todo</button>
  <button onclick="setCategory('movie')">üé• Pel√≠culas</button>
  <button onclick="setCategory('series')">üì∫ Series</button>
  <button onclick="window.location.href='index.html'">‚¨Ö Volver</button>
</header>

<input type="text" id="search" placeholder="üîç Buscar...">

<div id="gallery" class="grid"></div>

<footer>
  üåê Volver a <a href="https://cinenube.github.io/CineNubeGallery" target="_blank">CineNube</a>
</footer>

<script>
const catalogURL = 'https://raw.githubusercontent.com/CineNube/CineNubeGallery/main/catalogo.json';
let allItems = [];
let currentCategory = 'all';

async function loadCatalog() {
  try {
    const res = await fetch(catalogURL);
    const data = await res.json();
    allItems = data.reverse(); // recientes primero
    displayGallery();
  } catch(e) {
    console.error("Error al cargar cat√°logo:", e);
  }
}

function extractType(value) {
  if(!value) return 'movie';
  const str = String(value).toLowerCase();
  if(str.includes('series')) return 'series';
  if(str.includes('movie')) return 'movie';
  return 'movie';
}

function displayGallery() {
  const gallery = document.getElementById('gallery');
  gallery.innerHTML = '';
  const searchValue = normalize(document.getElementById('search').value);

  allItems.filter(item => {
    const type = extractType(item.type || item.tipo);
    if(currentCategory !== 'all' && type !== currentCategory) return false;
    if(!searchValue) return true;
    const text = normalize(`${item.title || item.titulo || ''} ${item.overview || item.descripcion || ''}`);
    return text.includes(searchValue);
  }).forEach(item => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.type = extractType(item.type || item.tipo);
    card.innerHTML = `
      <img src="${item.poster || item.imagen}" alt="${item.title || item.titulo}" class="poster">
      <div class="content">
        <div class="title">${item.title || item.titulo}</div>
        <div class="desc">${item.overview || item.descripcion || 'Sin descripci√≥n'}</div>
        <a href="${item.terabox || item.season_links || '#'}" target="_blank" class="link">Ver / Descargar</a>
      </div>
    `;
    gallery.appendChild(card);
  });
}

function setCategory(category) {
  currentCategory = category;
  displayGallery();
}

function normalize(str) {
  return str ? str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"") : "";
}

document.getElementById('search').addEventListener('input', displayGallery);

loadCatalog();
</script>
</body>
</html>
