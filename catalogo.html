<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CineNube Catálogo</title>
<style>
  body { font-family: Arial, sans-serif; background: #f9f9f9; margin:0; padding:0; }
  .container { max-width: 1200px; margin: auto; padding: 20px; display:grid; grid-template-columns: repeat(auto-fill,minmax(250px,1fr)); grid-gap: 20px; }
  .card { background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.1); display:flex; flex-direction:column; }
  .card img { width:100%; height:auto; }
  .card-body { padding:10px; flex-grow:1; display:flex; flex-direction:column; }
  .title { font-weight:bold; margin-bottom:5px; }
  .overview { flex-grow:1; font-size:0.9em; margin-bottom:5px; }
  .buttons a { display:inline-block; padding:5px 10px; margin:2px; background:#007bff; color:#fff; text-decoration:none; border-radius:4px; font-size:0.85em; }
</style>
</head>
<body>
<div class="container" id="catalog"></div>

<script>
const SHEET_JSON_URL = 'https://script.google.com/macros/s/AKfycbxxxxxxx/exec'; // Cambia al URL de tu WebApp

async function loadCatalog() {
  const container = document.getElementById('catalog');
  container.innerHTML = 'Cargando catálogo...';

  try {
    const res = await fetch(SHEET_JSON_URL);
    const data = await res.json();

    container.innerHTML = '';
    if(!data || data.length === 0){
      container.innerHTML = 'No hay items disponibles.';
      return;
    }

    data.forEach(item => {
      const card = document.createElement('div');
      card.className = 'card';

      const posterHTML = item.poster ? `<img src="${item.poster}" alt="${item.title}">` : '';
      const titleHTML = `<div class="title">${item.title}</div>`;
      const overviewHTML = item.overview ? `<div class="overview">${item.overview}</div>` : '';
      
      let buttonsHTML = '';
      if(item.season_links && item.season_links.length>0){
        buttonsHTML = '<div class="buttons">';
        item.season_links.forEach(s=>{
          if(s.link && s.link.includes('terabox')){
            buttonsHTML += `<a href="${s.link}" target="_blank">Temporada ${s.season}</a>`;
          }
        });
        buttonsHTML += '</div>';
      }

      card.innerHTML = posterHTML + '<div class="card-body">' + titleHTML + overviewHTML + buttonsHTML + '</div>';
      container.appendChild(card);
    });

  } catch(err) {
    container.innerHTML = 'Error al cargar el catálogo.';
    console.error(err);
  }
}

window.onload = loadCatalog;
</script>
</body>
</html>
